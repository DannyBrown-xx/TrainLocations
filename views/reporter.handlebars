<h1 id="message" style="display:none">Reporting Location!</h1>
<script src="https://cdn.socket.io/socket.io-1.3.7.js"></script>
<script>
  var socket = io();

  var headCode = prompt("Enter train headcode:", "1X01");
  document.getElementById('message').style.display = 'block';

  setInterval(reportLocation, 5000);

  socket.on('error', function() {
    document.getElementById('message').innerHTML = 'Encountered an error';
  });

  socket.on('disconnect', function() {
    document.getElementById('message').innerHTML = 'Disconnected';
  });

  function reportLocation() {
    navigator.geolocation.getCurrentPosition(function(position) {
      socket.emit('location-update', {
        'headCode' : headCode,
        'location' : {
          'latitude': position.coords.latitude,
          'longitude': position.coords.longitude
        }
      });
    });
    document.getElementById('message').innerHTML = 'Sending location';
    console.log('Sending location');
  }
</script>
